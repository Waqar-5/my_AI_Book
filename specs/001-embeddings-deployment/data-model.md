# Data Model: Website Embeddings Deployment & Vector DB Storage

## Entities

### 1. BookContent
**Description**: Represents the text extracted from Docusaurus-based book websites, including metadata such as source URL, page title, and content segmentation

**Fields**:
- id: string (auto-generated)
- source_url: string (URL of the original page)
- page_title: string (title of the page)
- raw_content: string (full text content extracted from the page)
- created_at: datetime (timestamp of extraction)
- updated_at: datetime (timestamp of last update)

**Relationships**:
- One-to-many with ContentChunk (one BookContent can have multiple chunks)

### 2. ContentChunk
**Description**: Segmented portion of book content, prepared for embedding generation

**Fields**:
- id: string (auto-generated)
- book_content_id: string (foreign key to BookContent)
- chunk_index: integer (sequence number of the chunk within the page)
- text_content: string (chunked text content)
- token_count: integer (number of tokens in the chunk)
- created_at: datetime (timestamp of chunking)

**Relationships**:
- Many-to-one with BookContent (multiple chunks belong to one BookContent)
- One-to-one with EmbeddingVector (one chunk maps to one embedding vector)

### 3. EmbeddingVector
**Description**: Semantic representation of text chunks generated by Cohere models, with associated metadata linking back to source content

**Fields**:
- id: string (auto-generated)
- content_chunk_id: string (foreign key to ContentChunk)
- vector: array<float> (embedding vector values, 1024 dimensions for Cohere)
- created_at: datetime (timestamp of embedding generation)

**Relationships**:
- Many-to-one with ContentChunk (one embedding corresponds to one content chunk)
- Stored in Qdrant database as payload with additional metadata

### 4. VectorDatabaseEntry (Qdrant Point)
**Description**: Storage unit in Qdrant containing embedding vectors with source content metadata

**Fields** (as Qdrant payload):
- id: string (Qdrant point ID, same as ContentChunk.id)
- vector: array<float> (1024-dimensional embedding vector)
- payload:
  - source_url: string (URL of the original page)
  - page_title: string (title of the page)
  - chunk_index: integer (index of the chunk)
  - text_content: string (raw text of the chunk)
  - created_at: datetime (timestamp of creation)

## Validation Rules

### BookContent Validation
- source_url: Must be a valid URL format
- page_title: Required, maximum 500 characters
- raw_content: Required, minimum 10 characters

### ContentChunk Validation
- text_content: Required, minimum 10 characters, maximum 10000 characters
- chunk_index: Required, non-negative integer
- token_count: Required, positive integer
- Must belong to a valid BookContent record

### EmbeddingVector Validation
- vector: Required, must have exactly 1024 dimensions
- content_chunk_id: Required, must reference an existing ContentChunk
- Vector values must be valid floats within expected embedding ranges

## State Transitions

### Content Processing Flow
1. Raw URL discovered → BookContent created (status: "discovered")
2. Content extracted from URL → BookContent updated (status: "extracted")
3. Content segmented → ContentChunk created (status: "chunked")
4. Embedding generated → EmbeddingVector created (status: "embedded")
5. Vector stored in Qdrant → VectorDatabaseEntry created (status: "stored")

## Indexes

### Qdrant Collection
- Vector index for efficient similarity search
- Payload indexes for source_url and page_title for filtering

### Database Indexes (if using additional storage)
- BookContent: index on source_url
- ContentChunk: index on book_content_id and chunk_index
- EmbeddingVector: index on content_chunk_id